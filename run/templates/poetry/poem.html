{% extends "base.html" %}

{% block head %}
{{ super() }}
<style>
    .match {color: black;}
    .mismatch {color: red;}
    .stressed {font-weight: bold;}
    .unstressed {}
    .missing {font-size: 80%;}
    .annotation {
        padding-right: 10px;
        padding-left: 10px;
    }
</style>
{% endblock %}


{% block title %}
{{ title }} - Metroscope
{% endblock title %}

{% block page_content %}
<h1>{{ title }}</h1>
<p>- by {{ poet }}, scanned in {{ meter }}.</p>
<div class='container'>
    <table>
{% for stanza in stanzas %}
{% set stanza_loop = loop %}
    {% for line in stanza %}
        <tr>
            <td class="text-center text-muted annotation">
                {% if stanza_loop.length == 1 %}
                <small>{{ loop.index }}</small>
                {% else %}
                <small>{{ stanza_loop.index }}.{{ loop.index }}</small>
                {% endif %}
            </td>
            <td>
        {% for word in line._matched_words() %}
            {% for syllable in word._matched_syllables() -%}
                <span class='{% if syllable.match %}match{% else %}mismatch{% endif %} {% if syllable.stress is none %}missing{% elif syllable.stress %}stressed{% else %}unstressed{% endif %}'>{{syllable.text}}</span>
            {%- endfor %}
        {% endfor %}
            </td>
            <td class="text-center text-muted annotation">
                <small data-toggle='tooltip' title='{{ line._rhyming_part }}'>{{ line.rhyme_designator }}</small>
            </td>
        </tr>
        {% if loop.last and not stanza_loop.last %}
        <tr><td></td><td class="text-center text-muted">*</td></tr>
        {% endif %}
    {% endfor %}
{% endfor %}
    </table>
</div>
{% endblock page_content %}

{% block scripts %}
{{super()}}
<script>
    $(document).ready(function(){
      $("[data-toggle='tooltip']").tooltip();
    });
</script>
{% endblock scripts %}
